<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adventure Roadmap & GFG Challenge Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0a0a0a; overflow: hidden; }
        .font-title { font-family: 'IM Fell English SC', serif; }
        #adventure-map-section {
            background-image: url('https://placehold.co/1600x600/0c4a6e/38bdf8?text=Your+Grand+Adventure');
            background-size: cover; background-position: center;
        }
        #player-avatar { transition: all 1.5s cubic-bezier(0.4, 0, 0.2, 1); filter: drop-shadow(0 4px 6px rgba(0,0,0,0.5)); }
        #roadmap-section { background-color: #1e1e1e; color: #d4d4d4; }
        .roadmap-list::-webkit-scrollbar { width: 10px; }
        .roadmap-list::-webkit-scrollbar-track { background: #2a2a2a; }
        .roadmap-list::-webkit-scrollbar-thumb { background-color: #854d0e; border-radius: 5px; border: 2px solid #2a2a2a; }
        .day-card {
            background-color: #2a2a2a; border-left: 5px solid #4a4a4a;
            transition: all 0.2s ease-in-out; cursor: pointer;
        }
        .day-card.status-completed { border-left-color: #16a34a; }
        .day-card.status-active { border-left-color: #f59e0b; box-shadow: 0 0 15px rgba(245, 158, 11, 0.3); }
        .day-card:hover { transform: translateY(-3px); background-color: #3a3a3a; }
        #task-modal { transition: opacity 0.3s ease-in-out; }
        .modal-content { 
            transition: transform 0.3s ease-in-out; background-color: #2a2a2a;
            border: 2px solid #854d0e; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body class="text-white">

    <div class="flex flex-col h-screen">
        <!-- Top Section: Adventure Map -->
        <div id="adventure-map-section" class="relative w-full h-1/2 border-b-4 border-amber-800">
            <svg id="adventure-map" class="absolute inset-0 w-full h-full" viewBox="0 0 1600 600" preserveAspectRatio="xMidYMid slice">
                <path id="map-path" d="M 100 500 C 250 350, 400 400, 550 250 S 800 100, 950 200 S 1200 450, 1500 400" stroke="#000000" stroke-opacity="0.4" stroke-width="6" fill="none" stroke-dasharray="12 12"/>
                <g id="map-locations"></g>
                <g id="player-avatar" transform="translate(100, 500)">
                    <path d="M 0 -25 L 18 0 L 0 8 L -18 0 Z" fill="#e11d48"/><circle cx="0" cy="0" r="15" fill="#f43f5e"/>
                    <text y="40" text-anchor="middle" font-size="18" fill="#fff" font-weight="bold" class="font-title" style="filter: drop-shadow(0 2px 2px rgba(0,0,0,0.8));">Hero</text>
                </g>
            </svg>
            <!-- Journal Button -->
            <a href="learning-journal.html" target="_blank" class="absolute top-4 right-4 bg-amber-800 text-white font-title py-2 px-5 rounded-lg hover:bg-amber-900 transition shadow-lg flex items-center space-x-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                <span>My Journal</span>
            </a>
        </div>

        <!-- Bottom Section: GFG Roadmap -->
        <div id="roadmap-section" class="w-full h-1/2 flex flex-col p-4">
            <h1 class="font-title text-4xl text-center text-amber-500 pb-2 mb-4">GFG 160-Day Roadmap</h1>
            <div id="roadmap-list" class="flex-grow overflow-y-auto roadmap-list pr-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                <!-- Day cards will be injected here by JS -->
            </div>
        </div>
    </div>

    <!-- Quest Editor Modal -->
    <div id="task-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 hidden z-50">
        <div class="modal-content p-6 w-full max-w-3xl rounded-lg transform scale-95 text-gray-200">
            <h3 id="modal-title" class="font-title text-3xl text-amber-500 mb-4">Quest Details</h3>
            <input type="hidden" id="modal-quest-day">
            <div class="space-y-4 max-h-[70vh] overflow-y-auto pr-2">
                <input type="text" id="modal-quest-question" placeholder="Today's question or goal..." class="w-full p-3 bg-transparent border-b-2 border-amber-800 focus:outline-none focus:border-amber-600 transition font-semibold text-lg">
                <textarea id="modal-quest-notes" placeholder="Your notes, solution, and thoughts..." rows="10" class="w-full p-3 bg-gray-800 rounded-md border border-gray-700 focus:outline-none focus:ring-2 focus:ring-amber-600 transition"></textarea>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <input type="text" id="modal-quest-topic" placeholder="Topic (e.g., Arrays)" class="w-full p-2 bg-transparent border-b-2 border-amber-800 focus:outline-none focus:border-amber-600 transition">
                    <select id="modal-quest-difficulty" class="w-full p-2 bg-gray-800 border border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-amber-600 transition">
                        <option value="Easy">Easy</option><option value="Medium">Medium</option><option value="Hard">Hard</option>
                    </select>
                </div>
            </div>
            <div class="flex justify-between items-center mt-6">
                <button id="modal-complete-btn" class="bg-green-700 text-white font-title py-2 px-5 rounded-lg hover:bg-green-800 transition">Complete Quest</button>
                <div>
                    <button id="modal-cancel-btn" class="font-title py-2 px-4 rounded-lg hover:bg-gray-700 transition mr-2">Close</button>
                    <button id="modal-save-btn" class="bg-amber-800 text-white font-title py-2 px-5 rounded-lg hover:bg-amber-900 transition">Save</button>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const roadmapList = document.getElementById('roadmap-list');
        const mapPath = document.getElementById('map-path');
        const playerAvatar = document.getElementById('player-avatar');
        const mapLocationsContainer = document.getElementById('map-locations');

        const taskModal = document.getElementById('task-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalQuestDay = document.getElementById('modal-quest-day');
        const modalQuestQuestion = document.getElementById('modal-quest-question');
        const modalQuestNotes = document.getElementById('modal-quest-notes');
        const modalQuestTopic = document.getElementById('modal-quest-topic');
        const modalQuestDifficulty = document.getElementById('modal-quest-difficulty');
        const modalSaveBtn = document.getElementById('modal-save-btn');
        const modalCancelBtn = document.getElementById('modal-cancel-btn');
        const modalCompleteBtn = document.getElementById('modal-complete-btn');

        const TOTAL_DAYS = 160;
        let quests = [];
        const milestoneMarkers = { 20: "Whispering Woods", 40: "Riverbend", 60: "Stonefall", 80: "Crystal Mountains", 100: "The Great Plains", 120: "Dragon's Peak", 140: "The Forgotten City", 160: "Journey's End" };
        const gfgQuestions = [
            "Reverse a string", "Find the maximum and minimum element in an array", "Kth smallest element", "Sort an array of 0s, 1s and 2s", "Move all negative numbers to beginning", "Find the Union and Intersection of two sorted arrays", "Kadane's Algorithm", "Minimize the Heights II", "Minimum number of jumps", "Find the duplicate in an array of N+1 integers", "Merge Two Sorted Arrays", "Merge Intervals", "Next Permutation", "Count Inversions", "Best Time to Buy and Sell Stock", "Find all pairs on integer array whose sum is equal to given number", "Find common elements in three sorted arrays", "Find first and last positions of an element in a sorted array", "Find a value in a rotated sorted array", "Search in a 2D matrix", "Median of two sorted arrays of different sizes"
        ];

        function generateInitialQuests() {
            return Array.from({ length: TOTAL_DAYS }, (_, i) => ({
                day: i + 1, status: i === 0 ? 'active' : 'locked',
                question: gfgQuestions[i] || `Day ${i + 1} Challenge`, 
                notes: '', topic: 'Arrays', difficulty: 'Medium'
            }));
        }

        function saveData() { localStorage.setItem('adventureRoadmapPro', JSON.stringify(quests)); }
        function loadData() {
            const saved = localStorage.getItem('adventureRoadmapPro');
            quests = saved ? JSON.parse(saved) : generateInitialQuests();
        }

        function renderAll() {
            renderRoadmap();
            renderMap();
        }

        function renderRoadmap() {
            roadmapList.innerHTML = '';
            quests.forEach(quest => {
                const card = document.createElement('div');
                card.className = `day-card p-4 rounded-lg status-${quest.status}`;
                card.dataset.day = quest.day;
                if (quest.status !== 'locked') {
                    card.onclick = () => openModal(quest.day);
                }
                card.innerHTML = `
                    <div class="flex justify-between items-center mb-1">
                        <span class="font-title text-lg">Day ${quest.day}</span>
                        <span class="text-xs font-semibold ${quest.status === 'completed' ? 'text-green-400' : 'text-gray-400'}">${quest.status.toUpperCase()}</span>
                    </div>
                    <p class="text-gray-300 truncate">${quest.question}</p>
                `;
                roadmapList.appendChild(card);
            });
        }

        function renderMap() {
            const pathLength = mapPath.getTotalLength();
            mapLocationsContainer.innerHTML = '';
            const completedDays = quests.filter(q => q.status === 'completed').length;

            Object.entries(milestoneMarkers).forEach(([day, name]) => {
                const progress = (day - 1) / (TOTAL_DAYS - 1);
                const point = mapPath.getPointAtLength(progress * pathLength);
                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.setAttribute('transform', `translate(${point.x}, ${point.y})`);
                g.innerHTML = `
                    <circle r="15" stroke="#fde047" stroke-width="4" fill="${day <= completedDays ? '#16a34a' : '#854d0e'}"></circle>
                    <text y="-25" text-anchor="middle" font-size="20" fill="#fff" class="font-title" style="filter: drop-shadow(0 2px 2px rgba(0,0,0,0.8))">${name}</text>
                `;
                mapLocationsContainer.appendChild(g);
            });

            const playerProgress = completedDays > 0 ? Math.min(1, (completedDays) / (TOTAL_DAYS - 1)) : 0;
            const playerPos = mapPath.getPointAtLength(playerProgress * pathLength);
            playerAvatar.setAttribute('transform', `translate(${playerPos.x}, ${playerPos.y})`);
        }

        function openModal(day) {
            const quest = quests.find(q => q.day === day);
            if (!quest) return;

            modalTitle.textContent = `Quest Details: Day ${day}`;
            modalQuestDay.value = day;
            modalQuestQuestion.value = quest.question;
            modalQuestNotes.value = quest.notes;
            modalQuestTopic.value = quest.topic;
            modalQuestDifficulty.value = quest.difficulty;
            modalCompleteBtn.style.display = quest.status === 'active' ? 'block' : 'none';

            taskModal.classList.remove('hidden');
            setTimeout(() => {
                taskModal.classList.remove('opacity-0');
                taskModal.querySelector('.modal-content').classList.remove('scale-95');
            }, 10);
        }

        function closeModal() {
            taskModal.classList.add('opacity-0');
            taskModal.querySelector('.modal-content').classList.add('scale-95');
            setTimeout(() => taskModal.classList.add('hidden'), 300);
        }

        function handleSave() {
            const day = parseInt(modalQuestDay.value);
            const questIndex = quests.findIndex(q => q.day === day);
            if (questIndex !== -1) {
                quests[questIndex].question = modalQuestQuestion.value.trim() || `Day ${day} Challenge`;
                quests[questIndex].notes = modalQuestNotes.value.trim();
                quests[questIndex].topic = modalQuestTopic.value.trim();
                quests[questIndex].difficulty = modalQuestDifficulty.value;
                saveData();
                renderRoadmap(); // Only need to re-render the list
            }
            closeModal();
        }

        function handleComplete() {
            const day = parseInt(modalQuestDay.value);
            const questIndex = quests.findIndex(q => q.day === day);
            if (questIndex !== -1 && quests[questIndex].status === 'active') {
                quests[questIndex].status = 'completed';
                if (day < TOTAL_DAYS) {
                    quests[questIndex + 1].status = 'active';
                }
                handleSave(); // Save data before closing
                renderAll(); // Re-render everything to show progress
            }
        }

        modalSaveBtn.addEventListener('click', handleSave);
        modalCancelBtn.addEventListener('click', closeModal);
        modalCompleteBtn.addEventListener('click', handleComplete);
        taskModal.addEventListener('click', (e) => { if (e.target === taskModal) closeModal(); });

        loadData();
        renderAll();
    });
    </script>
</body>
</html>
